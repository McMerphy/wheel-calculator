var wheelCalculator=angular.module("wheelCalculator",[]);wheelCalculator.controller("mainController",["$scope",function(e){e.firstWheel={tyreWidth:200,tyreProfile:50,tyreDiameter:15,wheelWidth:6,offset:30,color:"#E9DE30"},e.secondWheel={tyreWidth:240,tyreProfile:55,tyreDiameter:16,wheelWidth:6,offset:0,color:"#28CA28"},e.increase=function(e){e.wheelWidth<100&&(e.wheelWidth+=.5)},e.decrease=function(e){e.wheelWidth>0&&(e.wheelWidth-=.5)}}]),wheelCalculator.directive("wheelCanvas",function(){return{restrict:"E",scope:{firstWheel:"=firstWheel",secondWheel:"=secondWheel",backgroundImage:"@"},template:'<canvas id="board"></canvas>',link:function(e,t,r){function i(e,t){a(),h(e)}function l(e){n.beginPath(),n.lineWidth="3",n.strokeStyle=e.color;var t=140,r=220,i=t-(25.4*Number(e.wheelWidth)/2-Number(e.offset))/2,l=r-25.4*Number(e.tyreDiameter)/2/2;n.rect(i,l,25.4*Number(e.wheelWidth)/2,25.4*Number(e.tyreDiameter)/2),n.stroke(),n.beginPath(),n.strokeStyle="black",n.lineWidth="1",n.lineTo(i,l),n.lineTo(i+25.4*Number(e.wheelWidth)/2,l),n.lineTo(i+25.4*Number(e.wheelWidth)/4+Number(e.tyreWidth)/4,l-Number(e.tyreWidth)*Number(e.tyreProfile)/100/2),n.lineTo(i+25.4*Number(e.wheelWidth)/4-Number(e.tyreWidth)/4,l-Number(e.tyreWidth)*Number(e.tyreProfile)/100/2),n.lineTo(i,l),n.stroke(),n.beginPath(),n.strokeStyle="black",n.lineWidth="1",n.lineTo(i,l+25.4*Number(e.tyreDiameter)/2),n.lineTo(i+25.4*Number(e.wheelWidth)/2,l+25.4*Number(e.tyreDiameter)/2),n.lineTo(i+25.4*Number(e.wheelWidth)/4+Number(e.tyreWidth)/4,l+Number(e.tyreWidth)*Number(e.tyreProfile)/100/2+25.4*Number(e.tyreDiameter)/2),n.lineTo(i+25.4*Number(e.wheelWidth)/4-Number(e.tyreWidth)/4,l+Number(e.tyreWidth)*Number(e.tyreProfile)/100/2+25.4*Number(e.tyreDiameter)/2),n.lineTo(i,l+25.4*Number(e.tyreDiameter)/2),n.stroke()}function a(){n.clearRect(0,0,o.width,o.height)}function h(t){document.getElementById("myCanvas");baseImage=new Image,baseImage.src=e.backgroundImage,baseImage.onload=function(){o.width=baseImage.naturalWidth,o.height=baseImage.naturalHeight,n.drawImage(baseImage,0,0,baseImage.naturalWidth,baseImage.naturalHeight),l(e.firstWheel),l(e.secondWheel)}}var o=angular.element("#board")[0],n=o.getContext("2d");e.$watchCollection("firstWheel",i,!0),e.$watchCollection("secondWheel",i,!0)}}});